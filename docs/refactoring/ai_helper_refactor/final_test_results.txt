........................................................................ [ 20%]
........................................................................ [ 41%]
........................................................................ [ 61%]
........................................................................ [ 82%]
..............................................................           [100%]
================================ tests coverage ================================
_______________ coverage: platform darwin, python 3.13.2-final-0 _______________

Name                                                 Stmts   Miss Branch BrPart  Cover
--------------------------------------------------------------------------------------
app/__init__.py                                          0      0      0      0   100%
app/analysis_helpers.py                                335    284    184     12    12%
app/config.py                                           50     15      2      1    69%
app/data_assistant.py                                  308    145     44      7    50%
app/engine.py                                          304    163    128     29    39%
app/errors.py                                            6      0      0      0   100%
app/query_refinement/__init__.py                        11      7      4      0    27%
app/query_refinement/clarification_workflow.py          26     15      8      0    32%
app/query_refinement/clarifier.py                      114    103     60      0     6%
app/reference_ranges.py                                  9      6      2      0    27%
app/state.py                                           124     47     38      6    52%
app/ui.py                                              147     19     34      7    80%
app/utils/__init__.py                                    0      0      0      0   100%
app/utils/advanced_correlation.py                      269    164    144     20    36%
app/utils/ai/__init__.py                                 0      0      0      0   100%
app/utils/ai/code_generator.py                          20      1     14      1    94%
app/utils/ai/codegen/__init__.py                         8      0      0      0   100%
app/utils/ai/codegen/basic.py                           95     22     42      9    72%
app/utils/ai/codegen/change.py                          11      3      4      2    67%
app/utils/ai/codegen/comparison.py                       9      1      2      1    82%
app/utils/ai/codegen/correlation.py                     22      3      8      2    83%
app/utils/ai/codegen/fallback.py                        19     18      6      0     4%
app/utils/ai/codegen/top_n.py                           41      2      8      4    88%
app/utils/ai/codegen/trend.py                           28      3      8      1    83%
app/utils/ai/intent_parser.py                           70     18     24      6    72%
app/utils/ai/llm_interface.py                           59     27     20      4    46%
app/utils/ai/narrative_builder.py                       58     49     20      0    12%
app/utils/ai/prompt_templates.py                         7      0      0      0   100%
app/utils/ai/sql_builder.py                             59      8     28      8    79%
app/utils/ai_helper.py                                 224    137     92     14    36%
app/utils/assumptions.py                                45     12     18      5    63%
app/utils/auto_viz_mapper.py                            88     16     54      9    78%
app/utils/condition_mapper.py                          139     16     58      7    85%
app/utils/date_helpers.py                               89     38     38      8    54%
app/utils/db_migrations.py                              31      0      4      0   100%
app/utils/evaluation_framework.py                      222     45     54     14    77%
app/utils/feedback_db.py                                28      2      2      0    93%
app/utils/feedback_widgets.py                           68      6      2      1    90%
app/utils/gap_report.py                                 38      0      6      0   100%
app/utils/helpers.py                                    51      1     24      1    97%
app/utils/intent_clarification.py                       89      9     44      9    85%
app/utils/metric_reference.py                           46      7     22      7    79%
app/utils/patient_attributes.py                         59      0      8      0   100%
app/utils/plots.py                                     357     98    116     17    74%
app/utils/preprocess.py                                 55     10     34      9    74%
app/utils/query_intent.py                              212     57     96     25    68%
app/utils/query_logging.py                              36     10      4      2    70%
app/utils/results_formatter.py                         179    169    104      0     4%
app/utils/rule_loader.py                               101     58     32      5    39%
app/utils/sandbox.py                                   803    423    378     69    47%
app/utils/saved_questions_db.py                         76     32     10      0    51%
app/utils/schema.py                                      2      0      0      0   100%
app/utils/schema_cache.py                               35     22      6      0    32%
app/utils/silent_dropout.py                            121     51     40      7    50%
app/utils/test_overrides.py                              8      6      4      0    17%
app/utils/validation_engine.py                         294    137    120     11    52%
condition_test.py                                       31      3      2      1    88%
dev_tools/test_app.py                                   21     11      2      1    48%
dev_tools/test_correlation.py                           39      2      2      1    93%
dev_tools/test_import.py                                 7      1      0      0    86%
dev_tools/test_panel.py                                  9      2      2      1    73%
dev_tools/test_patient_data.py                          32      5     14      4    76%
dev_tools/test_scores_data.py                           22      0      6      0   100%
dev_tools/test_spinner.py                               16      3      6      3    73%
etl/json_ingest.py                                     101     21     22      6    75%
etl/seed_validation_rules.py                            80     68     24      1    12%
scripts/triage_tools/__init__.py                         0      0      0      0   100%
scripts/triage_tools/test_generator.py                  27     17      4      1    35%
test_dropouts.py                                        30      5      8      2    82%
test_new_conditions.py                                  33     28      2      1    17%
test_weight_change.py                                   44      0      0      0   100%
test_weight_change_with_units.py                        23     18      8      1    19%
tests/analysis/test_metric_reference.py                  8      0      0      0   100%
tests/analysis/test_preprocess.py                       38      0      0      0   100%
tests/chatgpt_tests/test_active_values.py                5      0      0      0   100%
tests/conftest.py                                      238     58     32      5    75%
tests/etl/test_db_migrations.py                         29      2      0      0    93%
tests/etl/test_json_ingest.py                           50      0      0      0   100%
tests/golden/run_daily_self_test.py                     79     62     12      2    21%
tests/golden/synthetic_self_test.py                    356    169     86      4    48%
tests/golden/test_enhanced_correlation.py              118      4     18      1    96%
tests/golden/test_golden_queries.py                    150     19     72     12    84%
tests/golden/test_queries.py                            37      6     12      6    76%
tests/golden/test_self_test_framework.py                55      2      6      2    93%
tests/intent/test_codegen.py                            14      0      0      0   100%
tests/intent/test_date_range.py                         47      0      0      0   100%
tests/intent/test_generate_analysis_code.py             11      0      0      0   100%
tests/intent/test_get_query_intent.py                   36      1     10      4    89%
tests/intent/test_group_by_templates.py                  8      0      0      0   100%
tests/intent/test_intent.py                             56      1      2      1    97%
tests/intent/test_trend_template.py                      8      0      0      0   100%
tests/intent/test_tricky_queries.py                     36      1     10      4    89%
tests/online/test_llm_intent_online.py                  30     21     10      1    25%
tests/performance/test_patient_list_refresh.py          12      0      0      0   100%
tests/sandbox/test_html_visualizations.py               47      0      2      0   100%
tests/sandbox/test_timeout.py                            8      0      0      0   100%
tests/sandbox/test_weight_change_sandbox.py             27      1      2      1    93%
tests/smoke/test_full_pipeline.py                       35      4      4      1    82%
tests/smoke/test_happy_path_average.py                  27      1      0      0    96%
tests/smoke/test_refactored_data_assistant.py          102      1      2      1    98%
tests/smoke/test_tricky_pipeline.py                     32      0      6      0   100%
tests/test_correlation_analysis.py                      83      0      0      0   100%
tests/test_data_assistant_reset.py                      32      0      0      0   100%
tests/test_integrated_gap_report.py                     94      3     22      1    93%
tests/test_smoke.py                                     56      0      0      0   100%
tests/utils/test_advanced_correlation.py               104      0     14      0   100%
tests/utils/test_auto_viz_mapper.py                    110      0      0      0   100%
tests/utils/test_condition_intent_clarification.py      30      0      0      0   100%
tests/utils/test_condition_mapper.py                    78      0      8      0   100%
tests/utils/test_condition_mapper_ai_fallback.py        66      0      0      0   100%
tests/utils/test_condition_query_intent.py              33      0      0      0   100%
tests/utils/test_correlation_heatmap.py                 29      0      8      0   100%
tests/utils/test_date_helpers.py                        15      0      0      0   100%
tests/utils/test_db_path_override.py                    20      1      2      1    91%
tests/utils/test_evaluation_framework.py               103      0      0      0   100%
tests/utils/test_feedback_db.py                         36      0      0      0   100%
tests/utils/test_feedback_widgets.py                    55      0      0      0   100%
tests/utils/test_gap_report.py                         117      0      0      0   100%
tests/utils/test_helpers.py                             60      0      0      0   100%
tests/utils/test_intent_clarification.py                60      0      0      0   100%
tests/utils/test_patient_attributes.py                 108      0      4      1    99%
tests/utils/test_plots.py                              107      0      0      0   100%
tests/utils/test_query_intent_program_completer.py       5      0      2      0   100%
tests/utils/test_query_logging.py                       16      0      0      0   100%
tests/utils/test_results_clarification.py               41      1      2      1    95%
tests/utils/test_sandbox.py                            115      0      0      0   100%
tests/utils/test_saved_questions_db.py                  40      2      0      0    95%
tests/utils/test_silent_dropout.py                      70      0      0      0   100%
tests/validation/__init__.py                             0      0      0      0   100%
tests/validation/test_engine_deep_checks.py             32      0      2      0   100%
tests/validation/test_engine_rules.py                   36      0      0      0   100%
tests/validation/test_rule_loader_smoke.py              27      0      0      0   100%
--------------------------------------------------------------------------------------
TOTAL                                                 9697   3029   2654    412    63%
350 passed, 1 skipped, 4 warnings in 19.48s
